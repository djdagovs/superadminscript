#!/bin/bash

#Variables
repeticiones=""
navegador=""
maxPaginasSimultaneas=""
sitioweb=""
contador="0"

clear

#Pedir introducir las veces que se abrirá la página
echo -e "$rojo$logo$gris"
echo -e "$verde Selecciona el número de veces que se visitará la página$gris"
echo -e "              $amarillo (Tiene que ser un número)$gris"
read repeticiones
clear

#Pedir la dirección de la página a visitar
echo -e "$rojo$logo$gris"
echo -e "$verde Escribe la página web o la dirección IP$gris"
echo -e "    $amarillo (por ejemplo: www.laguialinux.es)$gris"
read sitioweb
clear

#Pedir las páginas que se abrirán a la vez
echo -e "$rojo$logo$gris"
echo -e "$verde Cuantas páginas quieres abrir a la vez$gris"
echo -e "   $amarillo (recomiendo 10 si no lo sabes)$gris"
read maxPaginasSimultaneas
clear

#Seleccionar navegador
echo -e "$rojo$logo$gris"
echo ""
echo -e "          $verde Selecciona un navegador$gris"
echo ""
echo -e "                 $rojo 1$azul - Chrome$gris"
echo -e "                 $rojo 2$azul - Chromium$gris"
echo -e "                 $rojo 3$azul - Firefox$gris"
echo -e "                 $rojo 4$azul - Opera$gris"
echo -e "                 $rojo 5$azul - Iceweasel$gris"
echo -e "                 $rojo 6$azul - Epiphany$gris"
echo ""
echo -e "       $verde Selecciona un navegador para realizar las pruebas$gris"
echo -e "              $amarillo (Por supuesto tiene que estar$rojo instalado$amarillo)$gris"
echo ""
echo -e "$verde A continuación escribe el número de la opción elegida:$gris"
read navegadorelegido
    case $navegadorelegido in
        1)
            navegador="chrome";;
        2)#Condicional if: -d para comprobar si existe dir y -f para archivos -x permisos de ejecución
            if [ -f /usr/bin/chromium ]; then
                navegador="chromium"
            elif [ -f /usr/bin/chromium-browser ]; then
                navegador="chromium-browser"
            else
                echo -e "$rojo Se sale porque no está instalado el navegador elegido$gris"
                exit 1
            fi;;
        3)
            navegador="firefox";;
        4)
            navegador="opera";;
        5)
            navegador="iceweasel";;
        6)
            navegador="epiphany";;
        *)
            echo ""
            echo -e "$rojo          No existe esa opción$gris"
            echo ""
            exit 1;;
    esac
clear

#Resumen de lo que se realizará
echo -e "$rojo$logo$gris"
echo ""
echo -e "$verde   Se realizarán $rojo$repeticiones$verde conexiones a la página web $rojo$sitioweb$gris"
echo -e "$verde   Pero a la vez solo se abriran $rojo$maxPaginasSimultaneas$gris"
echo -e "$verde   Para ello se utilizará el navegador $rojo$navegador$gris"
echo ""
echo ""
echo -e "$amarillo Pulsa$rojo Intro$amarillo si todo está correcto o$rojo Control+C$amarillo para salir$gris"
read foo
clear

#Ejecución
echo -e "$rojo$logo$gris"
echo -e "$rojo            Realizando operaciones$gris"
while [ $contador -lt $( expr $repeticiones / $maxPaginasSimultaneas ) ]; do
    echo -e "$verde El contador actual es $contador"
    echo ""
        ContadorSimultaneo="0"
        while [ $ContadorSimultaneo -lt $maxPaginasSimultaneas ]; do
            $navegador $sitioweb&
            ContadorSimultaneo=$( expr $ContadorSimultaneo + 1 )
        done
    sleep 8
    contador=$( expr $contador + 1 )
    killall $navegador
    sleep 1
    clear
    echo -e "$rojo$logo$gris"
done

#Finalizando
clear
echo -e "$rojo$logo$gris"
echo ""
echo -e "$rojo Se ha terminado el script$gris"
echo -e "$rojo Puedes volver a ejecutarlo si asi lo deseas$gris"
echo ""
echo -e "$amarillo      Hasta la próxima$gris"
echo ""
echo ""

exit 1
